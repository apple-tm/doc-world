# 库存



#### 库存预警

1. 需求
   1. 商品表新增字段：商品预警数量（alarm_num）、预警标识(alarm_flag 0 标识库存正常，1 标识库存预警需要提醒商家进货)
   2. 定时任务：每天18 点定时查询对比每个商品的剩余数量和预警数量的大小，如果预警数量>剩余数量,那么将该商品的库存预警标识设置为 1（后续开发，商家登录系统时，查询商家的商品，判断哪些商品有库存预警，返回给前端，告知商家用户哪些需要进货）
   3. 商品批量上传后，商品的库存增加后刷新剩余数量，当天的 18 点会执行定时任务，刷新库存预警标识





#### 角色管理

1. 新增：

   1. 后端接口
      1. 入参：新增菜单 list，每个菜单包含菜单 ID，菜单 code
      2. service层：角色添加成功后返回 自增ID，新建一个角色菜单（权限）关联表的实体 List，每个对象组装（角色自增 ID，菜单 code（就是 permissionValue 字段），其他字段），mapper层，foreach 插入

   2. 前端
      1. 新增 model添加一个 checkbox，绑定点击事件，参数为 for 的当前对象，使用 Vue for 标签渲染（list 是菜单全部数据）
      2. data()中添加一个数组 保存选中的 checkbox的值，取消选择删除数组中的值
      3. 组装2点的数组，每个对象（菜单的 ID，菜单的 code），添加到 axios的参数角色对象中，对应后端的对象



#### 0425

角色管理改造

	1. 新增：增加一个角色对象（insert into js03_menu）,增加多个关联菜单列表（insert into  js03_role_menu ）
	2. 修改：先修改角色对象（update js03_menu），删除之前的多个关联菜单列表（delete from  js03_role_menu where role_id=修改的角色 ID），然后增加多个关联菜单列表（insert into  js03_role_menu ）
	3. 删除：删除角色，删除之前的多个关联菜单列表（delete from  js03_role_menu where role_id=删除的角色 ID）



#### 0428

登录改造

	1. 后台：登陆成功后，存储到 Redis 中，结构（uuid(key), user(value),30L(超时时间大小)，TImeUnit.minute(时间单位)），返回新增一个字段 token，值为 uuid
	2. 前端：存储用户信息（包含 token）
	3. 后台 AOP 登录校验，前端每次请求在请求头中加上 token:uuid, aop 后台获取 token，使用 token 获取 Redis 中内容，返回为空代表没有登录或者登录超时，返回，前端跳转到登录页面，Redis 返回不为空，通行到接口层





### 0505

用户登录成功排行榜（每天、每周、每月、每年） 前 10 名

接口调用次数（每天、每周、每月、每年）

