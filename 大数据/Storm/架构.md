# Storm 架构



#### 概述

1. 在**容错**和**水平可扩展**方法中处理大量数据
2. 分布式**实时处理系统的标准**



#### 架构

1. **Nimbus**（主节点）
   1. 运行Storm拓扑
   2. 分析拓扑并收集要执行的任务
   3. 将任务分配给可用的supervisor。
2. **Supervisor**（工作节点）
   1. 有一个或多个工作进程
   2. Supervisor将任务委派给**工作进程**
3. 工作进程
   1. 执行与特定拓扑相关的任务
   2. 不会自己运行任务，而是创建执行器并要求他们执行特定的任务。工作进程将有多个执行器。
4. Executor（执行者）：只是工作进程产生的单个线程。执行器运行一个或多个任务，但仅用于特定的spout或bolt。
5. ZooKeeper：
   1. Nimbus是**无状态**的，所以它**依赖于ZooKeeper来监视工作节点**的状态。
   2. 维护具有强大的同步技术共享数据之间进行协调的服务



#### 核心术语

1. Spouts：流的源。通常，Storm从原始数据源（如Twitter Streaming API，Apache Kafka队列，Kestrel队列等）接受**输入数据**。
2. Bolts：Bolts可以执行过滤，聚合，加入，与数据源和数据库交互的操作。
3. 实例：
   1. “Twitter分析”的输入来自Twitter Streaming API。Spout将使用Twitter Streaming API读取用户的tweets，并作为元组流输出。
   2. 来自spout的单个元组将具有twitter用户名和单个tweet作为逗号分隔值。
   3. Bolt将tweet拆分成单个字，计算字数，并将信息保存到配置的数据源。

#### 拓扑

1. Spouts和Bolts连接在一起，形成拓扑结构。实时应用程序逻辑在Storm拓扑中指定。简单地说，拓扑是有向图，其中**顶点是计算**，**边缘是数据流**。

#### 对比Hadoop

| Storm                                                        | Hadoop                                                  |
| ------------------------------------------------------------ | ------------------------------------------------------- |
| 实时流处理                                                   | 批量处理                                                |
| 无状态                                                       | 有状态                                                  |
| 主从架构，基于 zookeeper协调                                 | 主从架构                                                |
| Storm流过程在集群上**每秒可以访问数万条**消息。              | 使用MapReduce框架来处理大量的数据，需要几分钟或几小时。 |
| Storm拓扑运行直到用户关闭或意外的**不可恢复故障**。          | MapReduce作业按顺序执行并最终完成。                     |
| 如果nimbus / supervisor死机，重新启动使它从它停止的地方继续，因此没有什么受到影响。 | 如果JobTracker死机，所有正在运行的作业都会丢失。        |



#### 优势

1. 开源
2. 容错的，灵活的，可靠的，并且支持任何编程语言。
3. 实时流处理
4. 线性增加资源来保持性能，即使在负载增加的情况下。它是高度可扩展的。
5. 低的延迟。