# 缓存



#### 雪崩

1. 场景
   1. **缓存失效**
   2. 缓存数据还没有准备就绪，**没有预热**
   3. 高并发请求接入时无法阻挡
   4. 从而**查询数据库导致数据库宕机**或者延迟
   5. 数据库又被大量其他服务所依赖导致大面积服务崩溃，最终导致整个系统或网站的崩溃。非常高并发的场景才会发生
2. 解决方案
   1. **分布式锁**
      1. 只有一个线程能获得锁
      2. 获得后判断缓存数据是否存在，不存在获取缓存数据并更新缓存，存在获得数据，其他线程阻塞，更新缓存完成后或获得数据后释放锁
   2. **数据预热**
      1. 提前将数据缓存好，不等用户请求再缓存数据
      2. **错峰**更新缓存：更新缓存和用户请求高峰期错峰，**定时更新**策略
      3. 设置**不同的过期时间**，让**缓存失效时间尽量均匀**，这样**不会大量用户同时缓存失效**，避免雪崩



#### 穿透

1. 场景：没有命中一个数据（没查到），导致再查还是没查到直接将大量请求放到数据库上

2. 解决方案

   1. 缓存空数据，并设置合适的过期时间以更新缓存
   2. **布隆过滤器排除不可能有缓存值**的请求

   



